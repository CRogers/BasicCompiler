module Builtins

open Tree

$py(numeric=['Add','Sub','Div','Mul'])\
$py(numcomp=['Lt','Gt','LtEq','GtEq','Eq'])\
$py(boolean=['BoolAnd', 'BoolOr'])\

let binopToType binop ltype rtype = match (binop, ltype, rtype) with
$for(x in numeric)\
    | ($(x), Int x, Int y) -> Some (Int (max x y))
$endfor\
$for(x in numcomp)\
    | ($(x), Int _, Int _) -> Some Bool
$endfor\
$for(x in boolean)\
    | ($(x), Bool, Bool) -> Some Bool
$endfor\
    | _ -> None